---
title: Integrieren eines InfoPath-Formulars in eine Microsoft Access-Datenbank
manager: soliver
ms.date: 11/16/2014
ms.audience: Developer
localization_priority: Normal
ms.assetid: 5ec9a9c0-b348-4a31-b377-e95db2f92455
description: Microsoft InfoPath unterstützt die Verwendung einer Microsoft Access 2010-Datenbank als primäre Datenquelle für ein Formular oder als sekundäre Datenquelle für ein Formular oder Steuerelement. In diesem Artikel wird erläutert, wie Sie eine Access 2010-Datenbank als Datenquelle verwenden.
ms.openlocfilehash: dbc39e0d0908214904d77b8955f3d231f0bfb20b
ms.sourcegitcommit: 8fe462c32b91c87911942c188f3445e85a54137c
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 04/23/2019
ms.locfileid: "32303514"
---
# <a name="integrate-an-infopath-form-with-a-microsoft-access-database"></a><span data-ttu-id="33054-104">Integrieren eines InfoPath-Formulars in eine Microsoft Access-Datenbank</span><span class="sxs-lookup"><span data-stu-id="33054-104">Integrate an InfoPath Form with a Microsoft Access Database</span></span>

<span data-ttu-id="33054-105">Microsoft InfoPath unterstützt die Verwendung einer Microsoft Access 2010-Datenbank als primäre Datenquelle für ein Formular oder als sekundäre Datenquelle für ein Formular oder Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="33054-105">Microsoft InfoPath supports using a Microsoft Access 2010 database as the primary data source for a form, or as a secondary data source for a form or control.</span></span> <span data-ttu-id="33054-106">In diesem Artikel wird erläutert, wie Sie eine Access 2010-Datenbank als Datenquelle verwenden.</span><span class="sxs-lookup"><span data-stu-id="33054-106">This article explains how to use an Access 2010 database as a data source.</span></span>
  
## <a name="using-a-microsoft-access-database-as-a-data-source"></a><span data-ttu-id="33054-107">Verwenden einer Microsoft Access-Datenbank als Datenquelle</span><span class="sxs-lookup"><span data-stu-id="33054-107">Using a Microsoft Access Database as a Data Source</span></span>

### <a name="setting-up-a-microsoft-access-database-as-a-forms-primary-data-source"></a><span data-ttu-id="33054-108">Einrichten einer Microsoft Access-Datenbank als primäre Datenquelle eines Formulars</span><span class="sxs-lookup"><span data-stu-id="33054-108">Setting Up a Microsoft Access Database as a Form's Primary Data Source</span></span>

<span data-ttu-id="33054-109">Datenbankverbindungen werden in InfoPath mithilfe des datenVerbindungs- **Assistenten**eingerichtet.</span><span class="sxs-lookup"><span data-stu-id="33054-109">Database connections are established in InfoPath by using the **Data Connection Wizard**.</span></span> <span data-ttu-id="33054-110">Dieser Assistent wird geöffnet, indem Sie im Abschnitt **Erweiterte Formularvorlagen** auf der Registerkarte **neu** in Microsoft Office backstaging die Option **Datenbank** auswählen und dann auf **dieses Formular entwerfen**klicken.</span><span class="sxs-lookup"><span data-stu-id="33054-110">This wizard is opened by selecting **Database** in the **Advanced Form Templates** section on the **New** tab of the Microsoft Office Backstage, and then clicking pressing **Design This Form**.</span></span>
  
<span data-ttu-id="33054-111">Durch Klicken auf **Datenbank auswählen** können Sie eine vorhandene Datenquelle auswählen oder eine direkte Verbindung mit einer bestimmten Datenbankdatei herstellen.</span><span class="sxs-lookup"><span data-stu-id="33054-111">By clicking **Select Database**, you can choose an existing data source or connect directly to a specific database file.</span></span>
  
<span data-ttu-id="33054-p104">Nach der Auswahl einer Datenbank werden Sie vom Assistenten aufgefordert, in der Datenbank eine Tabelle auszuwählen, die als Datenquelle für das Formular verwendet werden soll. Beim Hinzufügen von Tabellen werden deren Beziehungen untereinander eingerichtet, und vom Assistenten werden die Tabellen und deren hierarchische Beziehungen in der Liste **Datenquellenstruktur** angezeigt. Wenn Sie das Kontrollkästchen **Tabellenspalten anzeigen** aktivieren, werden die Feldnamen jeder Tabelle in der Liste mit den Datenquellenstrukturen angezeigt. Mithilfe der Kontrollkästchen neben den einzelnen Feldnamen geben Sie an, ob ein Feld in die vom Assistenten erstellte SQL-Anweisung eingeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="33054-p104">After you select a database, the wizard prompts you to select a table from the database to use as the data source for the form. As you add tables, their relationships to each other are established, and the wizard displays the tables and their hierarchical relationships in the **Data source structure** list. If you select the **Show table columns** check box, the wizard displays the field names of each table in the Data source structure list; you use the check boxes next to each field name to specify whether a field is included in the SQL statement that the wizard constructs.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="33054-115">Primäre Schlüsselfelder aus den einzelnen Tabellen sind immer ausgewählt und können nicht entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="33054-115">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="33054-116">Wenn die Tabellen, Beziehungen und Felder mit dem datenVerbindungs- **Assistenten**angegeben wurden, können Sie auf **SQL bearbeiten** klicken, um die SQL-Anweisung anzuzeigen, die zum Festlegen der Datenquelle für das Formular verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="33054-116">When the tables, relationships, and fields have been specified using the **Data Connection Wizard**, you can click **Edit SQL** to view the SQL statement that will be used to establish the data source for the form.</span></span> <span data-ttu-id="33054-117">Im Dialogfeld **SQL bearbeiten** können Sie auf **SQL-Anweisung überprüfen** klicken, um zu überprüfen, ob die Datenquelle von InfoPath anhand der eingegebenen Informationen erstellt werden kann.</span><span class="sxs-lookup"><span data-stu-id="33054-117">In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided.</span></span> <span data-ttu-id="33054-118">Außerdem können Sie mithilfe des Dialogfelds **SQL bearbeiten** die SQL-Anweisung ändern, um komplexere Abfragen zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="33054-118">You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="33054-p106">Bei den von InfoPath verwendeten SQL-Anweisungen handelt es sich um Datenstrukturierungsabfragen. Sie ermöglichen das Erstellen hierarchischer Beziehungen zwischen mindestens zwei logischen Entitäten in einer Abfrage. JOIN-SQL-Anweisungen können verwendet werden. Allerdings wird davon abgeraten, da dann keine Formulare gesendet werden können. Weitere Informationen zu Datenstrukturierungsabfragen finden Sie in der Dokumentation im Microsoft Developer Network (MSDN).</span><span class="sxs-lookup"><span data-stu-id="33054-p106">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
<span data-ttu-id="33054-p107">Auf der letzten Seite im Datenverbindungs-Assistenten wird eine Zusammenfassung der Datenquelle angezeigt. Hierzu zählen der Name und der Dateispeicherort der Datenquelle, der Name der primären übergeordneten Tabelle, die Anzahl verwendeter Tabellen sowie der Sendestatus. Der Sendestatus zeigt an, ob die generierte SQL-Anweisung das erfolgreiche Senden der Daten an die Datenquelle ermöglicht.</span><span class="sxs-lookup"><span data-stu-id="33054-p107">The last page of the **Data Connection Wizard** displays summary information about the data source, including the name and file location of the data source, the name of the primary parent table, the number of tables used, and the submit status. The submit status tells you whether the generated SQL statement will allow for successful submission of data to the data source.</span></span> 
  
### <a name="setting-up-a-microsoft-access-database-as-a-secondary-data-source"></a><span data-ttu-id="33054-125">Einrichten einer Microsoft Access-Datenbank als sekundäre Datenquelle</span><span class="sxs-lookup"><span data-stu-id="33054-125">Setting up a Microsoft Access Database as a Secondary Data Source</span></span>

<span data-ttu-id="33054-p108">Mithilfe sekundärer Datenquellen können die Einträge für ein Listenfeld oder ein Dropdown-Listenfeld bereitgestellt werden. Sie können aber auch Code schreiben, um Ihren Formularen Daten aus einer sekundären Datenquelle hinzuzufügen. Um sekundäre Datenquellen in Ihrem Formular zu verwenden, klicken Sie beim Entwerfen eines Formulars auf der Registerkarte **Daten** auf **Datenverbindungen**.</span><span class="sxs-lookup"><span data-stu-id="33054-p108">Secondary data sources can be used to provide the entries for a list box or drop-down list box, or you can write code to add data from a secondary data source to your form. To work with secondary data sources in your form, click **Data Connections** on the **Data** tab when designing a form.</span></span> 
  
<span data-ttu-id="33054-128">Beim Starten des datenVerbindungs- **Assistenten**werden Sie aufgefordert auszuwählen, ob Daten im Formular empfangen oder Daten im Formular übermittelt werden sollen.</span><span class="sxs-lookup"><span data-stu-id="33054-128">When you start the **Data Connection Wizard**, you are prompted to select whether to receive data to use in the form, or to submit data in the form.</span></span> <span data-ttu-id="33054-129">Wählen Sie **Daten empfangen**aus, und klicken Sie dann auf **weiter**.</span><span class="sxs-lookup"><span data-stu-id="33054-129">Choose **Receive data**, and then click **Next**.</span></span> <span data-ttu-id="33054-130">Wenn Sie eine sekundäre Datenquelle aus einer Datenbank erstellen möchten, wählen Sie **Datenbank (nur Microsoft SQL Server oder Microsoft Office Access)** aus.</span><span class="sxs-lookup"><span data-stu-id="33054-130">To create a secondary data source from a database, select **Database (Microsoft SQL Server or Microsoft Office Access only)**.</span></span> <span data-ttu-id="33054-131">Klicken Sie auf der nächsten Seite des Assistenten auf **Datenbank auswählen** , um eine vorhandene Datenquelle auszuwählen oder eine direkte Verbindung mit einer bestimmten Datenbankdatei herzustellen.</span><span class="sxs-lookup"><span data-stu-id="33054-131">On the next page of the wizard, click **Select Database** to choose an existing data source or connect directly to a specific database file.</span></span> 
  
<span data-ttu-id="33054-p110">	Nach der Auswahl einer Datenbank werden Sie vom Assistenten aufgefordert, in der Datenbank eine Tabelle oder Abfrage auszuwählen, die als Datenquelle für das Formular verwendet werden soll. Sie müssen zunächst eine Tabelle oder Abfrage auswählen, können aber später bei Bedarf weitere Tabellen auswählen. Nachdem Sie eine Tabelle oder Abfrage ausgewählt haben, können Sie die Felder auswählen, die Sie in der Liste *\*Datenquellenstruktur** verwenden möchten. Standardmäßig sind alle Felder der Tabelle ausgewählt. Sie können jedoch Felder entfernen, falls diese für Ihr Formular nicht erforderlich sind. Darüber hinaus können Sie die Sortierung der von der Tabelle zurückgegebenen Datensätze festlegen und angeben, ob mehrere Datensätze zulässig sind. Dazu klicken Sie auf *\*Tabelle ändern** und wählen dann im Dialogfeld *\*Sortierreihenfolge** bis zu drei Sortierkriterien aus. Klicken Sie auf *\*Fertig stellen*\*, wenn die Angaben Ihren Vorstellungen entsprechen.</span><span class="sxs-lookup"><span data-stu-id="33054-p110">After you select a database, the wizard prompts you to select a table or query from the database to use as the data source for the form. You must select one table or query to begin with, but you can select additional tables later if you want to include them. After you've selected a table or query, the wizard allows you to select the fields you want to use in the **Data source structure** list. By default, all the fields of the table are selected, but you can remove fields if they aren't necessary for your form. You can also control how the records returned from the table are sorted, and whether multiple records are allowed. To do so, click **Modify Table**, and then select up to three sorting criteria in the **Sort Order** dialog box. When you're satisfied, click **Finish**.</span></span>
  
> [!NOTE]
> <span data-ttu-id="33054-139">Primäre Schlüsselfelder aus den einzelnen Tabellen sind immer ausgewählt und können nicht entfernt werden.</span><span class="sxs-lookup"><span data-stu-id="33054-139">Primary key fields from each table are always selected and cannot be removed.</span></span> 
  
<span data-ttu-id="33054-140">In InfoPath können Sie auch Daten aus mehreren Tabellen oder Abfragen gleichzeitig abrufen.</span><span class="sxs-lookup"><span data-stu-id="33054-140">InfoPath also enables you to retrieve data from multiple tables or queries at the same time.</span></span> <span data-ttu-id="33054-141">Wenn Sie Daten aus mehreren Tabellen oder Abfragen abrufen, müssen Sie in der Lage sein, eine Beziehung zwischen allen Tabellen oder Abfragen einzurichten, die mit der ursprünglichen Tabelle oder Abfrage verbunden sind, die Sie im datenVerbindungs- **Assistenten**ausgewählt haben.</span><span class="sxs-lookup"><span data-stu-id="33054-141">When you retrieve data from multiple tables or queries, you must be able to establish a relationship between all of the tables or queries involved with the original table or query you selected in the **Data Connection Wizard**.</span></span> <span data-ttu-id="33054-142">Wenn Sie beispielsweise Daten aus der Tabelle Customers der Northwind-Datenbank abgerufen haben, können Sie die Tabelle Orders hinzufügen, um Daten zu allen Bestellungen für diesen Kunden abzurufen, und Sie können die Tabelle Order Details hinzufügen, um die Details der einzelnen Reihenfolge abzurufen.</span><span class="sxs-lookup"><span data-stu-id="33054-142">For example, if you were retrieving data from the Customers table of the Northwind database, you could add the Orders table to retrieve data about all the orders for that customer, and you could add the Order Details table to retrieve the details of each order.</span></span>
  
<span data-ttu-id="33054-p112">Um der Datenquelle eine zusätzliche Tabelle hinzuzufügen, wählen Sie in der Liste **Datenquellenstruktur** die Tabelle aus, der Sie eine untergeordnete Tabelle hinzufügen möchten, und klicken Sie dann auf **Tabelle hinzufügen**. Wählen Sie die Tabelle oder Abfrage aus, die Sie hinzufügen möchten, und klicken Sie dann auf **Weiter**. Sie werden von InfoPath aufgefordert, die gewünschte Beziehung bzw. die gewünschten Beziehungen auszuwählen. Falls Felder in den beiden Tabellen den gleichen Namen aufweisen, werden diese Felder von InfoPath automatisch als Beziehung hinzugefügt. Andernfalls, oder falls Sie eine benutzerdefinierte Beziehung verwenden möchten, können Sie auf **Beziehung hinzufügen** klicken, um anzugeben, welche Felder in der übergeordneten Tabelle Feldern in der untergeordneten Tabelle entsprechen. Außerdem können Sie vorhandene Beziehungen entfernen, indem Sie im Dialogfeld **Beziehung bearbeiten** auf **Beziehung entfernen** klicken.</span><span class="sxs-lookup"><span data-stu-id="33054-p112">To add an additional table to the data source, select the table you want to add a child table to in the **Data source structure** list, and then click **Add Table**. Select the table or query you want to add, and then click **Next**. InfoPath prompts you to select the relationship or relationships you want to use. If fields in the two tables have the same name, InfoPath automatically adds those fields as a relationship, but if not, or if you want to use a custom relationship, you can click **Add Relationship** to specify which fields in the parent table correspond to fields in the child table. You can also remove existing relationships by clicking **Remove Relationship** in the **Edit Relationship** dialog box.</span></span> 
  
<span data-ttu-id="33054-p113">Klicken Sie auf **Fertig stellen**, wenn die Beziehungen Ihren Vorstellungen entsprechen. Wie bei der Haupttabelle können Sie angeben, welche Felder von der untergeordneten Tabelle zurückgegeben werden. Allerdings können Sie nicht mit der Schaltfläche **Tabelle ändern** die Reihenfolge bearbeiten, in der die Datensätze zurückgegeben werden.</span><span class="sxs-lookup"><span data-stu-id="33054-p113">When you're satisfied with the relationships, click **Finish**. As with the main table, you can specify which fields are returned from the child table. You cannot, however, use the **Modify Table** button to edit the order in which the records are returned.</span></span> 
  
<span data-ttu-id="33054-p114">Nachdem die Tabellen, Beziehungen und Felder angegeben wurden, können Sie durch Klicken auf **SQL bearbeiten** die SQL-Abfrageanweisung anzeigen, mit der die Datenquelle für das Formular eingerichtet wird. Im Dialogfeld **SQL bearbeiten** können Sie auf **SQL-Anweisung überprüfen** klicken, um zu überprüfen, ob die Datenquelle von InfoPath anhand der eingegebenen Informationen erstellt werden kann. Außerdem können Sie mithilfe des Dialogfelds **SQL bearbeiten** die SQL-Anweisung ändern, um komplexere Abfragen zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="33054-p114">When the tables, relationships, and fields have been specified, you can click **Edit SQL** to view the SQL query statement that will be used to establish the data source for the form. In the **Edit SQL** dialog box, you can click **Test SQL Statement** to verify that InfoPath will be able to create the data source from the information provided. You can also use the **Edit SQL** dialog box to modify the SQL statement to create more complex queries.</span></span> 
  
> [!NOTE]
> <span data-ttu-id="33054-p115">Bei den von InfoPath verwendeten SQL-Anweisungen handelt es sich um Datenstrukturierungsabfragen. Sie ermöglichen das Erstellen hierarchischer Beziehungen zwischen mindestens zwei logischen Entitäten in einer Abfrage. JOIN-SQL-Anweisungen können verwendet werden. Allerdings wird davon abgeraten, da dann keine Formulare gesendet werden können. Weitere Informationen zu Datenstrukturierungsabfragen finden Sie in der Dokumentation im Microsoft Developer Network (MSDN).</span><span class="sxs-lookup"><span data-stu-id="33054-p115">The SQL statements used by InfoPath are data shaping queries. Data shaping queries allow the building of hierarchical relationships between two or more logical entities in a query. It is possible to use SQL JOIN statements, but this is not recommended, because doing so will disable form submission. For more information on data shaping queries, see the documentation on the Microsoft Developer Network (MSDN).</span></span> 
  
## <a name="enabling-form-submission"></a><span data-ttu-id="33054-158">Aktivieren des Sendens von Formularen</span><span class="sxs-lookup"><span data-stu-id="33054-158">Enabling Form Submission</span></span>

<span data-ttu-id="33054-159">Neben dem Empfangen von Daten von einer Access-Datenbank kann InfoPath neue oder geänderte Daten an die Datenbank zurücksenden.</span><span class="sxs-lookup"><span data-stu-id="33054-159">In addition to receiving data from an Access database, InfoPath can submit new or changed data back to the database.</span></span> <span data-ttu-id="33054-160">Wenn Sie auf der \*\*\*\* Registerkarte **Start** oder in Microsoft Office backstaging die Änderungen an der Datenbank übermitteln, verwendet InfoPath ActiveX Data Objects (ADO), um die Datensätze in der Datenbank zu aktualisieren.</span><span class="sxs-lookup"><span data-stu-id="33054-160">When you use the **Submit** command on the **Home** tab or the Microsoft Office Backstage to submit changes to the database, InfoPath uses ActiveX Data Objects (ADO) to update the records in the database.</span></span> <span data-ttu-id="33054-161">Das Senden von Formularen ist möglich, wenn alle folgenden Bedingungen erfüllt sind:</span><span class="sxs-lookup"><span data-stu-id="33054-161">Form submission is enabled when all of the following conditions are met:</span></span> 
  
- <span data-ttu-id="33054-162">Für jede in der Formularabfrage verwendete Spalte muss eine Basisspalte vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="33054-162">There must be a base column for every column that is used in the form's query.</span></span>
    
- <span data-ttu-id="33054-163">Eine Tabellenspalte darf in der gesamten Abfrage nicht mehrmals vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="33054-163">A table column may not appear multiple times in the entire query.</span></span>
    
- <span data-ttu-id="33054-164">Ein Primärschlüssel, eine Eindeutigkeitseinschränkung oder ein eindeutiger Index muss für jede Tabelle in einer SELECT-Klausel vorhanden sein, die in der Formularabfrage verwendet wird.</span><span class="sxs-lookup"><span data-stu-id="33054-164">A primary key, unique constraint, or unique index must be available for every table in a SELECT clause that is used in the form's query.</span></span>
    
- <span data-ttu-id="33054-165">Eine Tabelle darf in der Formularabfrage nicht mehrmals vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="33054-165">A table cannot be included multiple times in the form's query.</span></span>
    
- <span data-ttu-id="33054-166">Beziehungen zwischen über- und untergeordneten Tabellen müssen alle Primärschlüsselspalten aus der übergeordneten Tabelle enthalten.</span><span class="sxs-lookup"><span data-stu-id="33054-166">Relationships between parent and child tables must include all primary key columns from the parent table.</span></span>
    
- <span data-ttu-id="33054-167">Für alle Spalten in einer SELECT-Klausel, die in der Formularabfrage verwendet wird, darf nur eine Basistabelle vorhanden sein.</span><span class="sxs-lookup"><span data-stu-id="33054-167">There can only be one base table for all columns in a SELECT clause that is used in the form's query.</span></span>
    
<span data-ttu-id="33054-168">Es gibt einige Umstände, unter denen InfoPath keine Formular Änderungen an eine Datenbank übermitteln kann.</span><span class="sxs-lookup"><span data-stu-id="33054-168">There are some circumstances under which InfoPath cannot submit form changes to a database.</span></span> <span data-ttu-id="33054-169">Wenn Sie beispielsweise ein Formular erstellen, das Daten aus einer Abfrage anstelle einer Tabelle zeichnet, oder wenn Sie die SQL-Anweisung anpassen, die von InfoPath verwendet wird, um eine JOIN-Anweisung einzufügen, kann InfoPath keine Änderungen übermitteln.</span><span class="sxs-lookup"><span data-stu-id="33054-169">For example, if you create a form that draws data from a query instead of a table, or if you customize the SQL statement that is used by InfoPath to include a JOIN statement, InfoPath will be unable to submit changes.</span></span> <span data-ttu-id="33054-170">Wenn Sie dem Formulartabellen hinzufügen möchten, die eine viele-zu-eins-Beziehung mit der übergeordneten Tabelle aufweisen, können Sie verhindern, dass InfoPath Änderungen übermittelt.</span><span class="sxs-lookup"><span data-stu-id="33054-170">Another circumstance that would prevent InfoPath from submitting changes is if you were to add tables to the form that have a many-to-one relationship with their parent table.</span></span> <span data-ttu-id="33054-171">In Situationen, in denen InfoPath keine Änderungen an der Datenbank übermitteln kann, wird im Feld **Sendestatus** auf der letzten Seite des Datenverbindungs- **Assistenten** der Grund für die Einschränkung angezeigt.</span><span class="sxs-lookup"><span data-stu-id="33054-171">In situations where InfoPath will be unable to submit changes to the database, the **Submit status** field on the last page of the **Data Connection Wizard** will display the reason for the limitation.</span></span> 
  

